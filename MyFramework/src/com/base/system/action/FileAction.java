package com.base.system.action;import java.io.File;import org.springframework.web.servlet.ModelAndView;import com.base.system.delegate.FileDelegate;import project.jun.dao.result.HoList;import project.jun.was.HoModel;import project.jun.was.HoSession;import project.jun.was.servlet.HoServlet;import project.jun.was.view.FileDownloadView;import project.jun.was.parameter.HoParameter;public class FileAction extends ProjectAction {	/*     * @return      * 	case1 : ModelAndView - 파일 다운로드 또는 Excel 다운로드시     * 	case2 : HoMessage,String, String[] / HoException,SQLException  - 처리결과 메시지 출력 화면 이동     * 	case3 : null 화면 View(jsp) 표시	 */	@Override	public Object execute(String actionFlag, HoModel model, HoParameter parameter, HoServlet   hoServlet) throws Exception {		// 파일 다운로드 기능..		if(actionFlag.equals("r_download_file") ) {			// 세션 초기화			hoServlet.getSession().setAttribute( HoSession.STATUS_FILE_DOWNLOAD_PROGRESS , String.valueOf(0));			parameter.infoParameter(false);			parameter.infoParameterValue(false);						FileDelegate delegate = (FileDelegate) super.getHoDelegate();			File downloadFile = delegate.download(actionFlag, model, parameter, parameter.getHoConfig());						logger.info(" downloadFile :" +  downloadFile );						// 파일 다운로드일 경우 새로운 ModelAndView를 return			return new ModelAndView("fileDownloadView", FileDownloadView.HO_FILE_DATA, downloadFile);		} 		// 엑셀 다운로드 기능..		else if(actionFlag.equals("r_download_excel") ) {			// 세션 초기화			hoServlet.getSession().setAttribute( HoSession.STATUS_EXCEL_DOWNLOAD_PROGRESS , String.valueOf(0));						parameter.infoParameter(false);			parameter.infoParameterValue(false);						FileDelegate delegate = (FileDelegate) super.getHoDelegate();			// 엑셀 다운로드 쿼리 실행..			delegate.excelDownload(actionFlag, model, parameter, parameter.getHoConfig());						// 엑셀 다운로드일 경우 새로운 ModelAndView를 return			return new ModelAndView("excelDownloadView");		} 		// 파일 업로드 상태		else if(actionFlag.equals("r_up_progress") ) {			this.setForwardPage( "/jsp/common/data/File.r_up_progress.jsp" );		} 		// 파일 다운로드 상태		else if(actionFlag.equals("r_down_progress") ) {			this.setForwardPage( "/jsp/common/data/File.r_down_progress.jsp" );		}		// 파일 다운로드 상태		else if(actionFlag.equals("r_excel_down_progress") ) {			this.setForwardPage( "/jsp/common/data/Excel.r_down_progress.jsp" );		}		return null;	}}